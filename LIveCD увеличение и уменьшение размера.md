#lvm #resize #reduce

- –£–º–µ–Ω—å—à–∏—Ç—å `/home` –¥–æ **100 –ì–ë**
    
- –î–æ–±–∞–≤–∏—Ç—å –æ—Å–≤–æ–±–æ–¥–∏–≤—à–µ–µ—Å—è –º–µ—Å—Ç–æ –∫ `/` (root)
    
- –í—Å—ë –±–µ–∑–æ–ø–∞—Å–Ω–æ, –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö
    

---

# üß± –ü—Ä–µ–¥–ø–æ—Å—ã–ª–∫–∏

|–†–∞–∑–¥–µ–ª|–û–±—ä—ë–º|–¶–µ–ª—å|
|---|---|---|
|`/home`|378 –ì–ë|–£–º–µ–Ω—å—à–∞–µ–º –¥–æ 100 –ì–ë|
|`/` (root)|69 –ì–ë|–£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –¥–æ ~348 –ì–ë|
|VG|`ro_redos`|Volume Group (–æ–±—â–∏–π –ø—É–ª LVM)|

---

# üõ† –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

## 1. üîå –ó–∞–≥—Ä—É–∑–∫–∞ —Å LiveCD

- –ò—Å–ø–æ–ª—å–∑—É–π **LiveCD –†–ï–î –û–°** –∏–ª–∏ –ª—é–±–æ–π –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤ —Å `lvm2`, `e2fsprogs` (–Ω–∞–ø—Ä–∏–º–µ—Ä, CentOS 7/8).
    
- –ó–∞–≥—Ä—É–∑–∏ —Å–∏—Å—Ç–µ–º—É —Å —Ñ–ª–µ—à–∫–∏ –≤ —Ä–µ–∂–∏–º–µ Live.
    

---

# üîß –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: –ø–µ—Ä–µ—Ä–∞–∑–º–µ—Ç–∫–∞ LVM —á–µ—Ä–µ–∑ LiveCD

## 2. üì° –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å LVM –∏ –Ω–∞–π—Ç–∏ —Ç–æ–º–∞

```bash
# –í–∫–ª—é—á–∞–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É LVM
lvm vgchange -ay

# –ü—Ä–æ–≤–µ—Ä–∏–º —Å–ø–∏—Å–æ–∫
lsblk
lvdisplay
```

–£–±–µ–¥–∏—Å—å, —á—Ç–æ –µ—Å—Ç—å:

- `/dev/ro_redos/root`
    
- `/dev/ro_redos/home`
    

---

## 3. üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã /home

```bash
e2fsck -f /dev/ro_redos/home
```

–ï—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏ ‚Äî –æ–Ω–∏ –±—É–¥—É—Ç —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã.

---

## 4. üîª –£–º–µ–Ω—å—à–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ /home –¥–æ 100–ì–ë

```bash
resize2fs /dev/ro_redos/home 100G
lvreduce -L 100G /dev/ro_redos/home
```

‚ö†Ô∏è –ü–æ—Å–ª–µ `lvreduce` –æ—Ç–∫–∞—Ç –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω –±–µ–∑ –±—ç–∫–∞–ø–∞. –£–±–µ–¥–∏—Å—å, —á—Ç–æ `resize2fs` –ø—Ä–æ—à—ë–ª –±–µ–∑ –æ—à–∏–±–æ–∫.

---

## 5. üî∫ –£–≤–µ–ª–∏—á–∏—Ç—å –∫–æ—Ä–Ω–µ–≤–æ–π —Ç–æ–º

```bash
lvextend -l +100%FREE /dev/ro_redos/root
resize2fs /dev/ro_redos/root
```

–ü—Ä–æ–≤–µ—Ä–∏–º:

```bash
df -hT /dev/ro_redos/root
```

---

## 6. üíæ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç:

```bash
mkdir /mnt/rootfs
mount /dev/ro_redos/root /mnt/rootfs
ls /mnt/rootfs
```

---

# üìå –§–∏–Ω–∞–ª

## 7. üîÅ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –≤ –æ—Å–Ω–æ–≤–Ω—É—é —Å–∏—Å—Ç–µ–º—É

```bash
reboot
```

–ò–∑–≤–ª–µ–∫–∏ —Ñ–ª–µ—à–∫—É/ISO.

---

# ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

|–†–∞–∑–¥–µ–ª|–ë—ã–ª–æ|–°—Ç–∞–ª–æ|
|---|---|---|
|`/home`|378 –ì–ë|100 –ì–ë|
|`/`|69 –ì–ë|~348 –ì–ë|

---

## üß† –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: –∫–æ–º–∞–Ω–¥—ã –Ω–∞ —Å–ª—É—á–∞–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

```bash
# –°–ø–∏—Å–æ–∫ VG –∏ LV
vgs
lvs

# –†–∞–∑–º–µ—Ä—ã —Ä–∞–∑–¥–µ–ª–æ–≤
lsblk -f

# –ü—Ä–æ–≤–µ—Ä–∫–∞ UUID –∏ —Ç–æ—á–µ–∫ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
blkid
cat /etc/fstab
```

---

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî –ø–æ–¥–≥–æ—Ç–æ–≤–ª—é —Ç–µ–±–µ ISO —Å –≤–∫–ª—é—á—ë–Ω–Ω—ã–º lvm2 –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏, –µ—Å–ª–∏ –≤ LiveCD —á–µ–≥–æ-—Ç–æ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç.  
–ì–æ—Ç–æ–≤ —Ç–∞–∫–∂–µ —Å–¥–µ–ª–∞—Ç—å PDF –¥–ª—è –æ—Ñ–ª–∞–π–Ω-–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏.