#nmcli #networkmanager #network 


1. Удалим все существующие соединения:

   ```
   sudo nmcli connection show | awk '{print $1}' | grep -v NAME | xargs -I {} sudo nmcli connection delete {}
   ```

2. Удалим все статические маршруты:

   ```
   sudo ip route flush all
   ```

   Эта команда удалит все записи из таблицы маршрутизации, кроме маршрутов, связанных с работающими интерфейсами.

3. Создадим новое соединение для каждого физического интерфейса с настройками DHCP:

   ```
   for iface in $(ls /sys/class/net | grep -v lo); do
       sudo nmcli connection add type ethernet con-name $iface ifname $iface
   done
   ```

4. Перезапустим NetworkManager для применения изменений:

   ```
   sudo systemctl restart NetworkManager
   ```

5. Проверим, что новые соединения созданы и активны:

   ```
   nmcli connection show
   ```

6. Если какие-то соединения не активировались автоматически, активируем их вручную:

   ```
   sudo nmcli connection up <имя_соединения>
   ```

7. Проверим, что интерфейсы получили IP-адреса и новые маршруты:

   ```
   ip addr
   ip route
   ```

После выполнения этих шагов все ваши сетевые интерфейсы должны быть настроены на автоматическое получение настроек через DHCP, а все ранее существовавшие статические маршруты будут удалены.

Важно отметить:
- Выполнение этих команд приведет к временному разрыву сетевого соединения.
- Если вы выполняете эти действия удаленно, убедитесь, что у вас есть альтернативный способ доступа к системе.
- В некоторых случаях может потребоваться перезагрузка системы для полного применения изменений, особенно если есть упорно сохраняющиеся маршруты или настройки.

