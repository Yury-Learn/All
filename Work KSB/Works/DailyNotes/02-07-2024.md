1. RuPost  #rupost
	1.  user CbybqRjydthn2!
	2. grub
		1. ruposT_gr0b
	tmux [[Tmux]]
	
2. fail2ban
3. Настройки PostgreSQL	#postgresql

	shared_buffers = 256MB  
	temp_buffers = 256MB  
	work_mem = 128MB  
	effective_io_concurrency = 1  
	max_worker_processes = 64  
	wal_buffers = 16MB  
	wal_writer_delay = 2000ms  
	wal_sync_method = open_sync  
	synchronous_commit = off  
	max_wal_size = 256MB
	
	Postgre_Rupost

4.  memcached!!!
	1. Размер выделяемой памяти рассчитывается по формуле: Требуемая память (килобайт) = 512 * (количество доменов LDAP) + (10 *  количество пользователей)  
	Требуемая память указывается в Мб конфигурационном файле /etc/memcached.conf.  
	/# set ram size to 8MBytes to 256MBytes  
	CACHESIZE="4096"  
	Указать требуемую память можно также через командный интерфейс Memcahed:  
	memcached -m 3072  #memcached 
	Ключ -m задает значение объема памяти в Мб.  
	Например:  
	-m 64  
	означает 64 Мб.  
	После внесения изменений нужно выполнить перезапуск сервиса memcached командой:  
	service memcached restart

5. NFS #nfs
	1. mkdir -p
		1. /srv/nfs/MailQueues
		2. /srv/nfs/MailStorage
		3. /srv/nfs/MailArchive
		4. /srv/nfs/MailRecord
		5. /srv/nfs/IndexFiles
	2. chown 420:420 -R
		1. /srv/nfs/MailQueues
		2. /srv/nfs/MailStorage
		3. /srv/nfs/MailArchive
		4. /srv/nfs/MailRecord
		5. /srv/nfs/IndexFiles
	3. apt install nfs-kernel-server
		1. Все экспортируемые файловые системы должны быть описаны в **/etc/exports**, начнем с корневой, добавим строки:
		/srv/nfs/MailQueues10.154.22.0/24(rw,sync,no_subtree_check,no_root_squash)  
		/srv/nfs/MailStorage 10.154.22.0/24(rw,sync,no_subtree_check,no_root_squash)  
		/srv/nfs/MailArchive 10.154.22.0/24(rw,sync,no_subtree_check,no_root_squash)  
		/srv/nfs/MailRecord 10.154.22.0/24(rw,sync,no_subtree_check,no_root_squash)  
		/srv/nfs/IndexFiles 10.154.22.0/24(rw,sync,no_subtree_check,no_root_squash)
	4. exportfs -ra
	5. systemctl restart|status nfs-server
	6. cat /var/lib/nfs/etab
	7. В примере рассматривается конфигурация, рассчитанная для обслуживания до 20000 почтовых ящиков, при среднестатиcтической ежедневной нагрузке 60% на чтение и 40% на запись. При указанной нагрузке к системным требованиям к серверу относятся:  
	• 4 ядра CPU;  
	• 4 оперативной памяти;  
	При этой конфигурации в файле /etc/default/nfs-kernel-server рекомендуется выставить параметр  
	RPCNFSDCOUNT, отвечающий за количество обработчиков соединений, равным произведению 32 на  
	количество процессорных ядер, т.е. для текущего примера:  
	/# Number of servers to start up  
	RPCNFSDCOUNT=128  
	также добавить эти настройки в файл `/etc/sysctl.conf`, чтобы они сохранялись после перезагрузки:
	```sh
	echo "net.core.wmem_max=8388608" | sudo tee -a /etc/sysctl.conf
	echo "net.core.rmem_max=8388608" | sudo tee -a /etc/sysctl.conf 
	echo "net.core.wmem_default=8388608" | sudo tee -a /etc/sysctl.conf
	echo "net.core.rmem_default=8388608" | sudo tee -a /etc/sysctl.conf
	```
	
	
```sh
	sysctl -p
```





openssl dhparam -out rupost-builtin-dhparam.pem 4096
rupost dhparam import /путь/rupost-builtin-dhparam.pem

- Для добавления собственных сертификатов, используемых при подключении клиентских приложений,  необходимо выполнить команду:

	rupost cert add "mail_cert" \  
	--login mailadmin \  
	--cert-type mail \  
	--cert-path certs/rupost-mail.crt \  
	--key-path certs/rupost-mail.key
где:  
• mail_cert - имя сертификата которое будет отображаться в БД  
• mailadmin - имя администратора от имени которого происходит загрузка  
• mail - тип сертификата  
• certs/rupost-mail.crt - путь до сертификата  
• certs/rupost-mail.key - путь до ключа

- Добавление сертификата для Панели управления аналогично процессу добавления сертификата для  клиентских приложений. Ключевым отличием является то, что используется другой тип:
	rupost cert add "control_panel_cert" \  
	--login mailadmin \  
	--cert-type control_panel \  
	--cert-path certs/rupost-control-panel.crt \  
	--key-path certs/rupost-control-panel.key
