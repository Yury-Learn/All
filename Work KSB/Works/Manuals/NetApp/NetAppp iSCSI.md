---
tags: netapp
---
Если вы не видите адреса iSCSI для вашего NetApp устройства, это может быть связано с несколькими причинами. Давайте рассмотрим основные из них и предложим решения для каждой.

### Возможные причины и решения

1. **Конфигурация сетевого интерфейса**

    Возможно, сетевой интерфейс, используемый для iSCSI, неправильно настроен или неактивен.

    #### Решение:
    Проверьте конфигурацию сетевых интерфейсов на вашем NetApp устройстве.

    ```bash
    net int show
    ```

    Убедитесь, что интерфейсы, назначенные для iSCSI, активны и имеют правильные IP-адреса.

2. **Служба iSCSI не запущена**

    Служба iSCSI может быть не запущена на вашем NetApp устройстве.

    #### Решение:
    Проверьте состояние службы iSCSI.

    ```bash
    iscsi service show
    ```

    Если служба не запущена, запустите её.

    ```bash
    iscsi service start
    ```

3. **iSCSI цели не настроены или неправильно настроены**

    Возможно, iSCSI цели (targets) не настроены или настроены неправильно.

    #### Решение:
    Проверьте конфигурацию iSCSI целей.

    ```bash
    iscsi interface show
    ```

    Убедитесь, что цели настроены правильно и привязаны к правильным интерфейсам.

4. **Проблемы с маршрутизацией или VLAN**

    Маршрутизация или VLAN могут быть неправильно настроены, что мешает доступу к iSCSI адресам.

    #### Решение:
    Проверьте настройки маршрутизации и VLAN.

    ```bash
    network route show
    network port vlan show
    ```

    Убедитесь, что маршруты и VLAN настроены правильно для сети, используемой для iSCSI.

5. **Проблемы с сетевой инфраструктурой**

    Возможно, проблема в сетевой инфраструктуре между вашим хостом и NetApp устройством, например, в коммутаторах, маршрутизаторах или кабелях.

    #### Решение:
    Проверьте физическое подключение и настройки сетевой инфраструктуры. Убедитесь, что все кабели исправны и правильно подключены, а также что сетевые устройства (коммутаторы, маршрутизаторы) настроены правильно.

6. **Проблемы с сетевой конфигурацией на хосте**

    Хост может быть неправильно настроен для подключения к iSCSI цели.

    #### Решение:
    Убедитесь, что iSCSI инициализатор на хосте настроен правильно. Проверьте конфигурационные файлы и сетевые настройки.

    ```bash
    iscsiadm -m node
    ```

### Дополнительные команды и примеры

#### Проверка состояния интерфейсов на NetApp

```bash
net int show
```

#### Пример вывода:

```bash
Logical    Status     Network      Current       Current Is
Interface              Address/Mask   MAC Address  Port
------------- ---------- -----------------  -------------- -------
e0M         up         192.168.0.10/24  00:a0:98:ff:ff:ff e0M
e0a         up         192.168.1.10/24  00:a0:98:ff:ff:fe e0a
```

#### Проверка iSCSI конфигурации

```bash
iscsi interface show
```

#### Пример вывода:

```bash
Interface   Target Name              Status      IP Address      Port
----------- ------------------------ ----------  --------------- -----
e0a         iqn.1992-08.com.netapp:  up          192.168.1.10    3260
            sn.12345678
```

#### Проверка маршрутов

```bash
network route show
```

#### Пример вывода:

```bash
Destination        Gateway         Metric
0.0.0.0/0          192.168.1.1     20
192.168.1.0/24     0.0.0.0         0
```

#### Проверка настроек VLAN

```bash
network port vlan show
```

#### Пример вывода:

```bash
Port       VLAN-ID  Name       Status
---------- -------- ---------- ------
e0a        100      vlan100    up
```

iscsiadm -m discovery -t st -p <target-ip>