 ```bash
tcdump -p -n -i *имяинтерфейса*
tcdump -pni *имяинтерфейса* tcp/udp/...
tcdump -pni *имяинтерфейса* host/src/dst 8.8.8.8/ya.ru

```

### 1. Синтаксис утилиты

1. Синтаксис команды **tcpdump** имеет следующий вид:
```sh
tcpdump _-опции_ _фильтры_
```

2. Для отображения списка сетевых интерфейсов, используемых в системе, выполните команду:
```sh
tcpdump -D
```

3. Для прослушивания конкретного сетевого интерфейса необходимо использовать опцию **-i** с именем интерфейса, передаваемого в качестве параметра. Например, для интерфейса под номером 2 команда будет иметь следующий вид:
```sh
tcpdump -i enp0s20f0u1
```

4. Если необходимо захватить трафик со всех сетевых интерфейсов, например, если в системе несколько сетевых подключений, в **tcpdump** для таких случаев предусмотрен специальный параметр **any**:
```sh
tcpdump -i any
```

### 2. Фильтры утилиты

Для упрощения поиска пакетов и экономии времени в **tcpdump** предусмотрены фильтры. Они используются для отсеивания ненужных пакетов. Таким образом можно вывести список пакетов, полученных от какого-либо конкретного IP-адреса или подсети.

- Описание фильтров для **tcpdump**:
	- **host**, **net**, **port** – для фильтрации по значению соответствующего идентификатора;
	    
	- **src**, **dst** – для фильтрации по конкретному направлению передачи к и/или от идентификатора;
	    
	- **tcp**, **udp**, **icmp**, **ah** – для фильтрации по заданному сетевому протоколу.

### 3. Примеры использования утилиты

1. Для просмотра исходящего и входящего трафика по IP-адресу выполните команду с фильтром **host** и соответствующим аргументом:
```sh
tcpdump host 192.168.1.1
```

2. Для обнаружения пакетов, следующих из определенной сети либо в нее, используйте команду с фильтром **net**:
```sh
tcpdump net 192.168.1.0/24
```

3. Для захвата трафика,  который поступает только на определенный порт, выполните команду с фильтром **port** и номером соответствующего порта в качестве аргумента:
```sh
tcpdump port 22
```

4. Для отсеивания трафика по отправителю с помощью фильтра **src**, выполните команду:
```sh
tcpdump src 192.168.1.1
```

5. Для отображения входящего трафика с IP-адреса выполните команду:
```sh
tcpdump dst 192.168.1.1
```

6. Для поиска конкретного типа трафика используются фильтры **tcp**, **udp**, **icmp**. Например, фильтр **icmp** поможет вывести на экран весь трафик, передаваемый по протоколу **ICMP**:
```sh
tcpdump icmp
```
### 4. Опция -w и -r

В таблице опций упоминалось о возможности сохранять все выводимые данные в отдельный файл, чтобы позже их можно было просмотреть. За это отвечает опция _-w_. Пользоваться ей довольно просто, всего-навсего укажите ее в команде, а затем впишите название будущего файла с расширением _«.pcap»_. Рассмотрим все на примере:

`sudo tcpdump -i ppp0 -w file.pcap`

Когда вы захотите просмотреть записанный вывод, необходимо использовать опцию _-r_, после которой написать название ранее записанного файла. Применяется она без других опций и фильтров:

`sudo tcpdump -r file.pcap`