---
tags: windows, gpo
---
## Exe

синтаксис

>psexec \\компьютер -u *пользователь* -p *пароль* *программа* *аргументы*

Где
	*-u пользователь -p пароль* – необязательные параметры, если у вашей учётной записи есть права на установку программ или права администратора в домене. Если нет – эти параметры помогают указать имя и пароль пользователя, который обладает достаточными правами.
	*программа* – имя исполняемого файла, (7z2107-x64.exe)
	*аргументы* – параметры установки программы, влияющие на сам процесс установки. Ещё аргументы называют **_ключами_**.
	- Например, аргумент /S - будет означать тихую установку программы, без участия пользователя на удалённом компьютере. Ключей тихой установки может быть множество, и для разных программ они могут отличаться. Подобрать их можно изучив документацию к программе, но как правило большинство из них являются универсальными.

```cmd
PsExec64.exe \\user_pc –c 7z2107-x64.exe /S
```
Где
	ключ –с копирует 7z2107-x64.exe на удалённый компьютер для последующего запуска

Для установки MSI пакетов в windows используется утилита msiexec, которая уже установлена в операционной системе. Как правило утилита эта находится в каталоге c:\Windows\system32\msiexec.exe.

Удобнее и быстрее будет если предварительно установочный файл скопировать на целевой компьютер и запускать его оттуда удалённо. В этом нам поможет встроенная в Windows утилита xcopy. У неё очень простой синтаксис в стиле:

>xcopy *что_копируем* *куда_копируем* *параметры_копирования*

```cmd
xcopy D:\silent\Chrome\GoogleChromeStandaloneEnterprise64.msi \\user_pc\c$\Windows\Temp\ /s /e
```

Где:
	*D:\\silent\\Chrome\\GoogleChromeStandaloneEnterprise64.msi* – полный пусть к файлу установки на нашем компьютере
	*\\user_pc\c$\Windows\Temp\* - путь назначения для копируемого файла на удалённом компьютере
	*/s /e* - Копирование каталогов с подкаталогами, включая пустые.


Теперь всё готово для запуска удалённой установки программы.

```cmd
psexec64.exe \\user_pc c:\Windows\system32\msiexec.exe /i c:\Windows\Temp\GoogleChromeStandaloneEnterprise64.msi /qn /quiet /norestart
```

- В первой части команды мы указываем утилите psexec64.exe имя удалённого компьютера *\\user_pc* и место расположение утилиты отвечающей за установку .msi файлов c:\\Windows\\system32\\msiexec.exe (как правило она всегда находится по этому пути), 
- далее идёт ключ /i, который означает что будет производиться именно установка программы (install), 
- после чего мы указываем полный пусть исполняемого файла на удалённом компьютере c:\Windows\Temp\GoogleChromeStandaloneEnterprise64.msi
- и в конце указываем несколько ключей тихой установки:
	/qn – полностью скрывает процесс установки от пользователя
	/quiet - тихий режим без взаимодействия с пользователем. Все окна будут скрыты. Если после обновления понадобиться перезагрузка, то она будет произведена.
	/norestart – отменяет перезагрузку, если она необходима после установки программы.