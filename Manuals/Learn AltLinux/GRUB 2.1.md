#learn #linux #alt #bash #grub #systemctl #journalctl #service

• Задание выполняется в контексте безопасности суперпользователя  
1. Посмотрите текущий уровень работы операционной системы инструментарием SystemV  
`runlevel` 
2. Посмотрите цель инициализации системы по-умолчанию  
 `systemctl get-default`  
3. Выполните перезагрузку системы  
4. В момент работы загрузчика GRUB перейдите в режим редактирования опций загрузки  
  <span style="background:#ff4d4f">**e** </span> 
5. Допишите в строчке загрузки ядра - начинается с linux указание загрузиться
в 3ий уровень выполнения, дописав в конце строки номер уровня

> [!В конце строки linux]
> 3
> 
1. Выполните загрузку
<span style="background:#ff4d4f">F10</span>
7. По окончании загрузки войдите в систему и перейдите в контекст безопасности суперпользователя
8. Посмотрите текущий уровень работы операционной системы инструментарием SystemV
 `runlevel`  
#### 2.2. Загрузка с замененным процессом init  
• Задание выполняется в контексте безопасности суперпользователя  
1. С использованием команды *which* определите путь к исполняемому файлу  
командного интерпретатора bash. Запомните/запишите его.  
2. Выполните перезагрузку системы  
3. В момент работы загрузчика GRUB перейдите в режим редактирования опций загрузки  
4. Допишите в строчке загрузке ядра ОС необходимость использовать командный интерпретатор вместо процесса init  
> [!Пишем в конце строки linux например /bin/bash]
> init=<путь к bash>
>   
1. Выполните загрузку операционной системы. 
2. Можно изменить *ro* на *rw* и сбросить **пароль суперпользователя**  
#### 2.3. Создание описания для сервиса  
1. Перезагрузите систему в режиме загрузки по-умолчанию  
2. Задание выполняется в контексте безопасности суперпользователя  
3. Запросите с github.com получение дополнительных файлов для проведения  
лабораторных занятий  
`git clone https://github.com/hse-labs/linux-lf.git`
4. При необходимости выполните установку пакета git-core средствами aptget  
`apt-get install git-core`
5. Ознакомьтесь с содержимым файла fake.service (Unit-файл сервиса) в полученном каталоге  
 `cat linux-lf/fake.service`  
6. Ознакомьтесь с текущим списком описаний сервисов для SystemD  
`ls /etc/systemd/system`  
`ls /lib/systemd/system`  
7. Скопируйте файл fake.service с описанием сервиса в каталог /etc/systemd/system  
`cp linux-lf/fake.service /etc/systemd/system/`  
8. Убедитесь, что описание сервиса скопировано  
`ls /etc/systemd/system/fake.service`  
#### 2.4. Запуск-статус-остановка сервиса  
1. Задание выполняется в контексте безопасности суперпользователя  
• Для выполнения дальнейших действий используйте утилиту *systemctl*  
2. Выполните запуск созданного сервиса *fake.service*  
3. Посмотрите статус работы сервиса  
4. Перезапустите созданный сервис  
5. Остановите сервис  
6. Настройте сервис на автоматический запуск  
#### 2.5. Управление сервисами  
1. Задание выполняется в контексте безопасности суперпользователя  
• Для выполнения дальнейших действий (п.2,4,6,7,8,10) используйте утилиту  
*systemctl*  
2. Уберите сервис **CUPS (cups.service)** из автозагрузки.  
3. Перезагрузитесь в третий уровень загрузки.  
 `telinit 3`  
4. Проверьте, запущен ли **CUPS**.  
5. Залогиньтесь пользователем sysadmin и перейдите в пятый уровень загрузки.  
`telinit 5`  
6. Проверьте, запущен ли **CUPS**.  
7. Запустите **CUPS**.  
8. Верните **CUPS** в автозагрузку.  
9. Перезагрузитесь в пятый уровень загрузки  
`telinit 5`  
10. Проверьте, запущен ли **CUPS**.  
#### 2.6. Журнал событий journald  
1. Задание выполняется в контексте безопасности суперпользователя  
2. Ознакомьтесь с настройками системы журнализации journald  
 `cat /etc/systemd/journald.conf`  
3. Обратите внимание на значение параметров  
• Storage  
• ForwardToSyslog  
4. Ознакомьтесь с расположением файлов журналов journald  
• в каталоге на диске /var/log/journal (если есть)  
• в каталоге в RAM-диске /run/log/journal (если есть)  
#### 2.7. Запросы средствами journalctl  
1. Задание выполняется в контексте безопасности суперпользователя  
2. Ознакомьтесь со встроенной справкой утилиты journalctl  
```
man journalctl  
journalctl --help  
```
3. Выполните вывод событий приоритета emerg  
`journalctl -p emerg`  
4. Выполните вывод событий ядра  
`journalctl -k`  
5. Выполните вывод событий службы sshd  
 `journalctl $(which sshd)` 
6. Выполните вывод событий пользователя sysadmin  
`journalctl _UID=$(id -u sysadmin)`  
7. Выполните вывод событий с момента загрузки системы  
`journalctl -b`  
8. Выполните вывод последних сообщений с возможной расшифровкой  
 `journalctl -xe`